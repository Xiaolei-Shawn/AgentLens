---
description: Record agent sessions with al-recorder MCP; use record_session_start, file_op/record_plan, record_session_end
alwaysApply: true
---

# AL Recorder session workflow

When the user asks you to do a task in this workspace, use the **al-recorder** MCP server to record the session so it can be replayed or inspected later.

## Flow

1. **Start** — At the beginning of the chat (after the user’s first request), call **record_session_start** with:
   - `session_id`: unique per chat (e.g. `chat-001` or `session-{short-slug}`)
   - `title`: short task summary (e.g. "Add login feature")
   - `user_message`: the user’s first message or a brief summary

2. **Plan** — Call **record_plan** with the same `session_id` and an ordered list of steps (e.g. `["Scaffold API", "Add auth", "Tests"]`). Optionally use **audit_event** for decisions or milestones.

3. **File changes** — For every file create/edit/delete, use **file_op** with `session_id`, `path`, `action` (`create` | `edit` | `delete`), and `content` for create/edit. This records and executes in one call. Do not rely only on the host’s write/edit tools if you want the session trace to include file evolution.

4. **End** — When the task is done, call **record_session_end** with the same `session_id` so the session is flushed to disk.

## If the user does not want recording

If the user says they don’t want this session recorded, or “skip recording,” do not call any al-recorder tools.

## Session output

Sessions are written to `AL_SESSIONS_DIR` (e.g. `sessions/`) as `{session_id}_{started_at_epoch}.json`. The user can list them via **list_sessions**.
